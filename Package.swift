// swift-tools-version:5.3

import PackageDescription

let package = Package(
    name: "Open3D-iOS",
    products: [
        .library(
            name: "Open3D-iOS",
            targets: [
                "LinkOpen3D",
                "Open3DSupport",
                "Assimp",
                "JPEG",
                "jsoncpp",
                "libOpen3D_3rdparty_liblzf.a",
                "libOpen3D_3rdparty_qhull_r.a",
                "libOpen3D_3rdparty_qhullcpp.a",
                "libOpen3D_3rdparty_rply.a",
                "libOpen3D.a",
                "png",
                "pybind.a",
                "TBB",
                // "libvtkCommonComputationalGeometry",
                "libvtkCommonDataModel",
                "libvtkCommonMath",
                "libvtkCommonExecutionModel",
                "libvtkCommonMisc",
                "libvtkCommonSystem",
                "libvtkCommonCore",
                "libvtkCommonTransforms",
                "libvtkFiltersCore",
                "libvtkFiltersGeneral",
                "libvtkFiltersModeling",
                "libvtkFiltersSources",
                "libvtkfmt",
                // "libvtkkissfft",
                "libvtkpugixml",
                "libvtksys",
            ]),
    ],
    dependencies: [
        .package(url: "https://github.com/kewlbear/NumPy-iOS.git", .branch("main")),
        .package(url: "https://github.com/kewlbear/LAPACKE-iOS.git", .branch("main")),
        .package(url: "https://github.com/kewlbear/BLAS-LAPACK-AppStore-Workaround.git", .branch("main")),
    ],
    targets: [
        .binaryTarget(name: "Assimp", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/Assimp.xcframework.zip", checksum: "43134201d603cc8a1b15ab9bd65e064711afd4e01f83b7a86c17d7e07ff3f093"),
        .binaryTarget(name: "JPEG", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/JPEG.xcframework.zip", checksum: "19468a161759be58d88ab2c13deeea3812f7f3379cee603cdbba8c5fc0ed483f"),
        .binaryTarget(name: "jsoncpp", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/jsoncpp.xcframework.zip", checksum: "060b26fe6e5bb0091d53925f05ee0aae8f0ac86184a12b81f227e07b2100c8c0"),
        .binaryTarget(name: "libOpen3D_3rdparty_liblzf.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/libOpen3D_3rdparty_liblzf.a.xcframework.zip", checksum: "ac0d83757499e864ae58cc948a08989346be0822e8bf68102533f800d80c736d"),
        .binaryTarget(name: "libOpen3D_3rdparty_qhull_r.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/libOpen3D_3rdparty_qhull_r.a.xcframework.zip", checksum: "52f4a6a1383217c4cdf427f654ad6d9e70c39bc5fe179f48eadc96e6ec3a0953"),
        .binaryTarget(name: "libOpen3D_3rdparty_qhullcpp.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/libOpen3D_3rdparty_qhullcpp.a.xcframework.zip", checksum: "6dd60855ad0f31ef3c1055fca4ca1bc58b923841e47a383cee0c99b7f17b23c2"),
        .binaryTarget(name: "libOpen3D_3rdparty_rply.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/libOpen3D_3rdparty_rply.a.xcframework.zip", checksum: "79330ae4442447d15dd9084ae38eae8b211993b504834e87c57914197c3897ca"),
        .binaryTarget(name: "libOpen3D.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/libOpen3D.a.xcframework.zip", checksum: "83732d17e360b47a918e34388dd4c081a662de941d2d65d4fcfc3b7e3eec7ace"),
        .binaryTarget(name: "png", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/png.xcframework.zip", checksum: "f9b37538fc1478504ecdad1e297cdd5c4694ddeaa94186d79bc9eb4e237702a3"),
        .binaryTarget(name: "pybind.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/pybind.a.xcframework.zip", checksum: "843c53ad990ee0523226c755335962be93c76e4bc14280039f143ac3f65e8c69"),
        .binaryTarget(name: "TBB", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/TBB.xcframework.zip", checksum: "576ac906969daac4c8cdd9856633c727ee460dc8f57fe47f2f1c2c53e9032885"),
        // .binaryTarget(name: "libvtkCommonComputationalGeometry", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_Common_Computational.xcframework.zip", checksum: "eac86dd73ccbcd0c2a0fe43bc5800afdd8b77777b3845f8ffb41687c3db22388"),
        .binaryTarget(name: "libvtkCommonDataModel", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_common_data_model.xcframework.zip", checksum: "7342b6ecadd2f0335bc0bc18309617c5b2cc9dc7cdd1057d94d1511355448b4c"),
        .binaryTarget(name: "libvtkCommonMath", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_common_math.xcframework.zip", checksum: "dc5100d2f507e4bb943a81eeecd24d44150ab22a30ce1ba0d217e03ad85f9e9f"),
        .binaryTarget(name: "libvtkCommonExecutionModel", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_common_execution.xcframework.zip", checksum: "db68636a5808bc32f2ed3d4f08161fcda8de48addfac28db09046bb746a3177b"),
        .binaryTarget(name: "libvtkCommonMisc", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_common_misc.xcframework.zip", checksum: "10ddc2a5bfc732bef53933c19a9da20a63182431d564a2d51dff9c7f43077614"),
        .binaryTarget(name: "libvtkCommonSystem", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_common_sys.xcframework.zip", checksum: "8cb766d3c20a183a5a25c3067f3105386b4f7c3e37a0336687126cc9e5962cbe"),
        .binaryTarget(name: "libvtkCommonCore", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_common_core.xcframework.zip", checksum: "34ac09b23a89d190ed4dc875f91f1204d08db6a4f26f5bbb6c61bc4528168d4f"),
        .binaryTarget(name: "libvtkCommonTransforms", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_common_trans.xcframework.zip", checksum: "d2a80a7220c131d6519d602e3986f967e1a05956bcc96ab61ac6c82e631d885c"),
        
        .binaryTarget(name: "libvtkFiltersCore", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_filte_core.xcframework.zip", checksum: "16aa1c92ed2bd5056cf851a654a4fc2ef3ccebad36507d2b56648e9625985609"),
        .binaryTarget(name: "libvtkFiltersGeneral", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_filte_general.xcframework.zip", checksum: "7b8088abcdb6bff3929604fe62dfa8d81e0ab715c33acea3d46eee1f8e1d66a9"),
        .binaryTarget(name: "libvtkFiltersModeling", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_filte_model.xcframework.zip", checksum: "5e88ddcd94f0e359fd57554ededede5cfcd30098e94686e65aeb1f0413229448"),
        .binaryTarget(name: "libvtkFiltersSources", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_filte_src.xcframework.zip", checksum: "1358e5d20780a1a686540031d166471dc3b814f11fc30c16279150b43fa7c241"),
        .binaryTarget(name: "libvtkfmt", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_fmt.xcframework.zip", checksum: "b429ae393f3fb45c3bd1783e012e62bd0651cd9fdf99ab2fea82f762e14999cc"),
        // .binaryTarget(name: "libvtkkissfft", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_kiss_fft.xcframework.zip", checksum: "21135a3dce19db295abe4bdf9b55ab34a99bcfe590bfdd47cfe77dd2f97c8a91"),
        .binaryTarget(name: "libvtkpugixml", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_plugin_xml.xcframework.zip", checksum: "6be47a3ed3da10354f3a1e63061592a9b8543b23a312c57d4468dd0f79fd9e17"),
        .binaryTarget(name: "libvtksys", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520184913/VTK_sys.xcframework.zip", checksum: "a6cd50c8d1a55fe26367988a709276fc425b743e5939d2d50f0eac0b65a9c920"),
        .target(
            name: "LinkOpen3D",
            dependencies: [
                "NumPy-iOS",
                "LAPACKE-iOS",
                "Assimp",
                "JPEG",
                "jsoncpp",
                "libOpen3D_3rdparty_liblzf.a",
                "libOpen3D_3rdparty_qhull_r.a",
                "libOpen3D_3rdparty_qhullcpp.a",
                "libOpen3D_3rdparty_rply.a",
                "libOpen3D.a",
                "png",
                "pybind.a",
                "TBB",
                "BLAS-LAPACK-AppStore-Workaround",
                // "libvtkCommonComputationalGeometry",
                "libvtkCommonDataModel",
                "libvtkCommonMath",
                "libvtkCommonExecutionModel",
                "libvtkCommonMisc",
                "libvtkCommonSystem",
                "libvtkCommonCore",
                "libvtkCommonTransforms",
                "libvtkFiltersCore",
                "libvtkFiltersGeneral",
                "libvtkFiltersModeling",
                "libvtkFiltersSources",
                "libvtkfmt",
                // "libvtkkissfft",
                "libvtkpugixml",
                "libvtksys",
            ],
            linkerSettings: [
                .linkedLibrary("stdc++"),
            ]
        ),
        .target(
            name: "Open3DSupport",
            resources: [.copy("site-packages")]),
        .testTarget(
            name: "Open3D-iOSTests",
            dependencies: ["Open3DSupport"]),
    ]
)
