// swift-tools-version:5.3

import PackageDescription

let package = Package(
    name: "Open3D-iOS",
    products: [
        .library(
            name: "Open3D-iOS",
            targets: [
                "LinkOpen3D",
                "Open3DSupport",
                "Assimp",
                "JPEG",
                "jsoncpp",
                "libOpen3D_3rdparty_liblzf.a",
                "libOpen3D_3rdparty_qhull_r.a",
                "libOpen3D_3rdparty_qhullcpp.a",
                "libOpen3D_3rdparty_rply.a",
                "libOpen3D.a",
                "png",
                "pybind.a",
                "TBB",
                // "libvtkCommonComputationalGeometry",
                "libvtkCommonDataModel",
                "libvtkCommonMath",
                "libvtkCommonExecutionModel",
                "libvtkCommonMisc",
                "libvtkCommonSystem",
                "libvtkCommonCore",
                "libvtkCommonTransforms",
                "libvtkFiltersCore",
                "libvtkFiltersGeneral",
                "libvtkFiltersModeling",
                "libvtkFiltersSources",
                "libvtkfmt",
                // "libvtkkissfft",
                "libvtkpugixml",
                "libvtksys",
                "libUVAtlas",
            ]),
    ],
    dependencies: [
        .package(url: "https://github.com/kewlbear/NumPy-iOS.git", .branch("main")),
        .package(url: "https://github.com/kewlbear/LAPACKE-iOS.git", .branch("main")),
        .package(url: "https://github.com/kewlbear/BLAS-LAPACK-AppStore-Workaround.git", .branch("main")),
    ],
    targets: [
        .binaryTarget(name: "Assimp", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/Assimp.xcframework.zip", checksum: "dbab4bd1376ac8a4ebde372082981c6cad37effa019880220c42d7279e94cc8d"),
        .binaryTarget(name: "JPEG", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/JPEG.xcframework.zip", checksum: "af03d9a2d9dc3b39b78a5ebc16e4f3d6b554660daa02bb12faf07757fe1916a6"),
        .binaryTarget(name: "jsoncpp", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/jsoncpp.xcframework.zip", checksum: "e884430340f9efb53ea3fb6bdcdc83629629b0f0541f541434ac8311dfe8fca9"),
        .binaryTarget(name: "libOpen3D_3rdparty_liblzf.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/libOpen3D_3rdparty_liblzf.a.xcframework.zip", checksum: "d7f58ab4d9f7a80d0f4f94f30186925ec48d9e6b940180bab904e77de1755fe9"),
        .binaryTarget(name: "libOpen3D_3rdparty_qhull_r.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/libOpen3D_3rdparty_qhull_r.a.xcframework.zip", checksum: "d8a13851c0fa3512c6e0f570c986d714a2d9de1fcb6720b1c4a276a9e25a165a"),
        .binaryTarget(name: "libOpen3D_3rdparty_qhullcpp.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/libOpen3D_3rdparty_qhullcpp.a.xcframework.zip", checksum: "1b7033384f9d7702e6b09a0d777c79b0e88c95a3fc8d34bcbc7042aad4a3aec5"),
        .binaryTarget(name: "libOpen3D_3rdparty_rply.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/libOpen3D_3rdparty_rply.a.xcframework.zip", checksum: "7870eedd0d8a075e2e5179f8e02c1055164fc227e4c752837fcf8ed03ed5eafc"),
        .binaryTarget(name: "libOpen3D.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/libOpen3D.a.xcframework.zip", checksum: "b138cc1529e08c3cd4836425edafd8e90e1680c9e763d46df037c9871c12e844"),
        .binaryTarget(name: "png", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/png.xcframework.zip", checksum: "40e0ffbf0504b7587fd0516a4ca0e10415b9d4cc57c26b5b8138257aef3d0946"),
        .binaryTarget(name: "pybind.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/pybind.a.xcframework.zip", checksum: "2f729570e239f89a53129cfc159b8569c7c41b454b8a18823272f521e17f3610"),
        .binaryTarget(name: "TBB", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/TBB.xcframework.zip", checksum: "40b67bac47ff1f9acc9f3b3998b92fb7138c17096cf5fcc54a8608a4ae2a55ee"),
        // .binaryTarget(name: "libvtkCommonComputationalGeometry", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_Common_Computational.xcframework.zip", checksum: "658b31b912eb43e42b02a4f2221eec4c6bacbbbdc3e135d609c4c5d85c2ab1fe"),
        .binaryTarget(name: "libvtkCommonDataModel", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_common_data_model.xcframework.zip", checksum: "5c82bec6316d8296214193c053c518897bed1c1a0e8555bb604cebba01169e4d"),
        .binaryTarget(name: "libvtkCommonMath", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_common_math.xcframework.zip", checksum: "91061a7cd0f07975baf7a3c80c636936ac011e9106fc933d3e06ecdf820db558"),
        .binaryTarget(name: "libvtkCommonExecutionModel", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_common_execution.xcframework.zip", checksum: "29463ed6b7eb29c8f24844c522748f800ae467f96854908c77ee1a9fcf9c40be"),
        .binaryTarget(name: "libvtkCommonMisc", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_common_misc.xcframework.zip", checksum: "691c63696f5939556e8625489700d8b0691ccc8a53e3bec88a5ca4c46811ae55"),
        .binaryTarget(name: "libvtkCommonSystem", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_common_sys.xcframework.zip", checksum: "32e6cdb22a7ba2096996eea064530159c8d3578bc79ae5c085f725d1bf87eb93"),
        .binaryTarget(name: "libvtkCommonCore", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_common_core.xcframework.zip", checksum: "d2ded4cc95c37073479a9856b179615bd92c31b4936dd8c415adb16730e0d557"),
        .binaryTarget(name: "libvtkCommonTransforms", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_common_trans.xcframework.zip", checksum: "e0305bea5d8d032ef222ab942cb304ae4dfb1e3c6a03666a8d671291b4c2c96f"),
        
        .binaryTarget(name: "libvtkFiltersCore", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_filte_core.xcframework.zip", checksum: "a57290101a195f072ea06a9d32526e6d7d0f680aed7fd29d6b37abd04518c1cd"),
        .binaryTarget(name: "libvtkFiltersGeneral", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_filte_general.xcframework.zip", checksum: "8771ff4c37fd643f84383064f28051bb79c1cb25d90b16393403fbdc44f8fca7"),
        .binaryTarget(name: "libvtkFiltersModeling", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_filte_model.xcframework.zip", checksum: "34a974624a3d7a182c20a0ab8bac7a269f0239f2adfed9043b90a7c169b34a5c"),
        .binaryTarget(name: "libvtkFiltersSources", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_filte_src.xcframework.zip", checksum: "5445ad89981cb1ad5fe955a66d423d782f1821e30eae76cfecd7f067e099799a"),
        .binaryTarget(name: "libvtkfmt", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_fmt.xcframework.zip", checksum: "bc395b6468746ecfcd2b680e487d5b1763285c1be2f45dcfb8942f31c8e44e29"),
        // .binaryTarget(name: "libvtkkissfft", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_kiss_fft.xcframework.zip", checksum: "8ce1fe1c75a37683ceca5c72715cbdc3fb14458ffe7db42d4469ed4d47c19fc6"),
        .binaryTarget(name: "libvtkpugixml", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_plugin_xml.xcframework.zip", checksum: "57c9226784fed5611bd6513017db72b24acfc8db2af9f931a439fbc486b85524"),
        .binaryTarget(name: "libvtksys", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/VTK_sys.xcframework.zip", checksum: "6db1ce60ee0eba2072c25b7b5e8ee8a2bd37d45a4402465081c29451c15cf0d2"),
        .binaryTarget(name: "libUVAtlas", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240521065849/UVAtlas.xcframework.zip", checksum: "507a6294af685b2b6d305e93c51139430c2f0d61304f99727be4898b6f359633"),
        .target(
            name: "LinkOpen3D",
            dependencies: [
                "NumPy-iOS",
                "LAPACKE-iOS",
                "Assimp",
                "JPEG",
                "jsoncpp",
                "libOpen3D_3rdparty_liblzf.a",
                "libOpen3D_3rdparty_qhull_r.a",
                "libOpen3D_3rdparty_qhullcpp.a",
                "libOpen3D_3rdparty_rply.a",
                "libOpen3D.a",
                "png",
                "pybind.a",
                "TBB",
                "BLAS-LAPACK-AppStore-Workaround",
                // "libvtkCommonComputationalGeometry",
                "libvtkCommonDataModel",
                "libvtkCommonMath",
                "libvtkCommonExecutionModel",
                "libvtkCommonMisc",
                "libvtkCommonSystem",
                "libvtkCommonCore",
                "libvtkCommonTransforms",
                "libvtkFiltersCore",
                "libvtkFiltersGeneral",
                "libvtkFiltersModeling",
                "libvtkFiltersSources",
                "libvtkfmt",
                // "libvtkkissfft",
                "libvtkpugixml",
                "libvtksys",
                "libUVAtlas",
            ],
            linkerSettings: [
                .linkedLibrary("stdc++"),
            ]
        ),
        .target(
            name: "Open3DSupport",
            resources: [.copy("site-packages")]),
        .testTarget(
            name: "Open3D-iOSTests",
            dependencies: ["Open3DSupport"]),
    ]
)
