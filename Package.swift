// swift-tools-version:5.3

import PackageDescription

let package = Package(
    name: "Open3D-iOS",
    products: [
        .library(
            name: "Open3D-iOS",
            targets: [
                "LinkOpen3D",
                "Open3DSupport",
                "Assimp",
                "JPEG",
                "jsoncpp",
                "libOpen3D_3rdparty_liblzf.a",
                "libOpen3D_3rdparty_qhull_r.a",
                "libOpen3D_3rdparty_qhullcpp.a",
                "libOpen3D_3rdparty_rply.a",
                "libOpen3D.a",
                "png",
                "pybind.a",
                "TBB",
                // "libvtkCommonComputationalGeometry",
                "libvtkCommonDataModel",
                "libvtkCommonMath",
                "libvtkCommonExecutionModel",
                "libvtkCommonMisc",
                "libvtkCommonSystem",
                "libvtkCommonCore",
                "libvtkCommonTransforms",
                "libvtkFiltersCore",
                "libvtkFiltersGeneral",
                "libvtkFiltersModeling",
                "libvtkFiltersSources",
                "libvtkfmt",
                // "libvtkkissfft",
                "libvtkpugixml",
                "libvtksys",
            ]),
    ],
    dependencies: [
        .package(url: "https://github.com/kewlbear/NumPy-iOS.git", .branch("main")),
        .package(url: "https://github.com/kewlbear/LAPACKE-iOS.git", .branch("main")),
        .package(url: "https://github.com/kewlbear/BLAS-LAPACK-AppStore-Workaround.git", .branch("main")),
    ],
    targets: [
        .binaryTarget(name: "Assimp", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/Assimp.xcframework.zip", checksum: "12f4e68b7d74e1c6184934aa03fca6dad4ba54b6b993ed89627aed259612c6a2"),
        .binaryTarget(name: "JPEG", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/JPEG.xcframework.zip", checksum: "ea0ba1998b3a2e0f846472241c0ff50d7c5929b9d0f9898e4eb3f1f2a26d12c7"),
        .binaryTarget(name: "jsoncpp", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/jsoncpp.xcframework.zip", checksum: "a475a4089434e326016234105cca92711a484f63864b86f126e1f7b9caa53b09"),
        .binaryTarget(name: "libOpen3D_3rdparty_liblzf.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/libOpen3D_3rdparty_liblzf.a.xcframework.zip", checksum: "b0babed83ef142ed568b91593aff19e53619bae66980e64e87aef5c9c24afb97"),
        .binaryTarget(name: "libOpen3D_3rdparty_qhull_r.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/libOpen3D_3rdparty_qhull_r.a.xcframework.zip", checksum: "5a656e04d83dc49ea6025fe00251494d6144f622bb99c9548e95c72b03481520"),
        .binaryTarget(name: "libOpen3D_3rdparty_qhullcpp.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/libOpen3D_3rdparty_qhullcpp.a.xcframework.zip", checksum: "44a2e56f0bf08e2d31140ff61a7b2f1d56e86b8fcc527f4f76fd1eb2c6925cfe"),
        .binaryTarget(name: "libOpen3D_3rdparty_rply.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/libOpen3D_3rdparty_rply.a.xcframework.zip", checksum: "a0e91e06ebc7a69f3eb14360c0771188eb669f2f2b903febe9ed167df940b478"),
        .binaryTarget(name: "libOpen3D.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/libOpen3D.a.xcframework.zip", checksum: "6b0d39330628bfc45d25931617de04275a4220e3ea0b9dad3277f48d6bf0fb2f"),
        .binaryTarget(name: "png", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/png.xcframework.zip", checksum: "caf5ca11cd9827c489be95c072c2030f99a1bb4c2e9853b1c3576c0aaf1afcec"),
        .binaryTarget(name: "pybind.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/pybind.a.xcframework.zip", checksum: "e535dc40f8e230bfd0b63433fce79e17d13780a92b6874b958486b9d326ebbcc"),
        .binaryTarget(name: "TBB", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/TBB.xcframework.zip", checksum: "8a9c935a301bcf6ce1d7dd6ed4b7c34a4af0d8de1a498348a75eabf3850e70fd"),
        // .binaryTarget(name: "libvtkCommonComputationalGeometry", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_Common_Computational.xcframework.zip", checksum: "6d773f2346e241b4c5538408ba2e60c7bd7cf02a418dcf2ec3d5499487079fe2"),
        .binaryTarget(name: "libvtkCommonDataModel", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_common_data_model.xcframework.zip", checksum: "eda8e57147d794aca9f25434822065561683df27afe4e7f9a97c5d03bac6ac91"),
        .binaryTarget(name: "libvtkCommonMath", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_common_math.xcframework.zip", checksum: "0d7d440d18f8a724fe9911331412929ea47730a7f6a87960a0edcc1f2c476b47"),
        .binaryTarget(name: "libvtkCommonExecutionModel", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_common_execution.xcframework.zip", checksum: "e062d770aeb395c68ef6ab6835c6fc044d6ab2e0a87c147ac5ae9b7935a30f01"),
        .binaryTarget(name: "libvtkCommonMisc", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_common_misc.xcframework.zip", checksum: "1cea1290de92e93ba8120ce818e9f39000c16503490dea0024a3577dc9fcd061"),
        .binaryTarget(name: "libvtkCommonSystem", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_common_sys.xcframework.zip", checksum: "391e9fe9342bf79e9672e7a2ef9826a58c7e8c5abc79870331656e3760cdba72"),
        .binaryTarget(name: "libvtkCommonCore", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_common_core.xcframework.zip", checksum: "28b4d6765f2d54b6d0618939a82b427bc769eb89c1b760a4bc695ebc4011e446"),
        .binaryTarget(name: "libvtkCommonTransforms", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_common_trans.xcframework.zip", checksum: "820b57ae26514d139eed95a6bc8be60b63e7cde02b13ee872a31642f96426e70"),
        
        .binaryTarget(name: "libvtkFiltersCore", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_filte_core.xcframework.zip", checksum: "4babe8c604eaacf6491f52f811f558959a534bf6108ccc24732edbb0d0008aa2"),
        .binaryTarget(name: "libvtkFiltersGeneral", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_filte_general.xcframework.zip", checksum: "46f03a70f6390775f7c002d7cdc882d2141c3e6b00e75e9bbc59c0eaed8de214"),
        .binaryTarget(name: "libvtkFiltersModeling", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_filte_model.xcframework.zip", checksum: "c07e3f7dea2c83b0de79103550311308a139e8a15d9a28c0f41c1655d41c051f"),
        .binaryTarget(name: "libvtkFiltersSources", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_filte_src.xcframework.zip", checksum: "389bcfd7bfe4d3360b55cf86397d4be8ee4f0b206764786d68c1804b9be53ec2"),
        .binaryTarget(name: "libvtkfmt", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_fmt.xcframework.zip", checksum: "614225177b8e404f4b924b3da3a0316b7cd7d2f651dd96f8f1ea31a5d7ada33e"),
        // .binaryTarget(name: "libvtkkissfft", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_kiss_fft.xcframework.zip", checksum: "346e7dd17e5b7dfc5769478c9f4cf973144f9182b9716d0aeae66cac5ebdf83a"),
        .binaryTarget(name: "libvtkpugixml", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_plugin_xml.xcframework.zip", checksum: "76dcb43638b44dcb5b5e675e099ae9e692bcfe77a89eaf8dc4967361c242c43a"),
        .binaryTarget(name: "libvtksys", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240520104500/VTK_sys.xcframework.zip", checksum: "b0488cf4f792bc4c35651ea787b8e8633e11f5133a0b8add5dd1d4b3ec91403c"),
        .target(
            name: "LinkOpen3D",
            dependencies: [
                "NumPy-iOS",
                "LAPACKE-iOS",
                "Assimp",
                "JPEG",
                "jsoncpp",
                "libOpen3D_3rdparty_liblzf.a",
                "libOpen3D_3rdparty_qhull_r.a",
                "libOpen3D_3rdparty_qhullcpp.a",
                "libOpen3D_3rdparty_rply.a",
                "libOpen3D.a",
                "png",
                "pybind.a",
                "TBB",
                "BLAS-LAPACK-AppStore-Workaround",
                // "libvtkCommonComputationalGeometry",
                "libvtkCommonDataModel",
                "libvtkCommonMath",
                "libvtkCommonExecutionModel",
                "libvtkCommonMisc",
                "libvtkCommonSystem",
                "libvtkCommonCore",
                "libvtkCommonTransforms",
                "libvtkFiltersCore",
                "libvtkFiltersGeneral",
                "libvtkFiltersModeling",
                "libvtkFiltersSources",
                "libvtkfmt",
                // "libvtkkissfft",
                "libvtkpugixml",
                "libvtksys",
            ],
            linkerSettings: [
                .linkedLibrary("stdc++"),
            ]
        ),
        .target(
            name: "Open3DSupport",
            resources: [.copy("site-packages")]),
        .testTarget(
            name: "Open3D-iOSTests",
            dependencies: ["Open3DSupport"]),
    ]
)
