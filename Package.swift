// swift-tools-version:5.3

import PackageDescription

let package = Package(
    name: "Open3D-iOS",
    products: [
        .library(
            name: "Open3D-iOS",
            targets: [
                "LinkOpen3D",
                "Open3DSupport",
                "Assimp",
                "JPEG",
                "jsoncpp",
                "libOpen3D_3rdparty_liblzf.a",
                "libOpen3D_3rdparty_qhull_r.a",
                "libOpen3D_3rdparty_qhullcpp.a",
                "libOpen3D_3rdparty_rply.a",
                "libOpen3D.a",
                "png",
                "pybind.a",
                "TBB",
                // "libvtkCommonComputationalGeometry",
                "libvtkCommonDataModel",
                "libvtkCommonMath",
                "libvtkCommonExecutionModel",
                "libvtkCommonMisc",
                "libvtkCommonSystem",
                "libvtkCommonCore",
                "libvtkCommonTransforms",
                "libvtkFiltersCore",
                "libvtkFiltersGeneral",
                "libvtkFiltersModeling",
                "libvtkFiltersSources",
                "libvtkfmt",
                // "libvtkkissfft",
                "libvtkpugixml",
                "libvtksys",
            ]),
    ],
    dependencies: [
        .package(url: "https://github.com/kewlbear/NumPy-iOS.git", .branch("main")),
        .package(url: "https://github.com/kewlbear/LAPACKE-iOS.git", .branch("main")),
        .package(url: "https://github.com/kewlbear/BLAS-LAPACK-AppStore-Workaround.git", .branch("main")),
    ],
    targets: [
        .binaryTarget(name: "Assimp", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240512110206/Assimp.xcframework.zip", checksum: "03330437997a92863465effe5a2613699ae69cf04d0050495b991ca847cc6535"),
        // .binaryTarget(name: "Assimp", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/Assimp.xcframework.zip", checksum: "265165f19c4b21e5d5e333703eff48b273333d8434ee912c608a662f89468bb3"),
        .binaryTarget(name: "JPEG", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/JPEG.xcframework.zip", checksum: "0028700c31164d3a50cabb10e63b17e59d8f357245eb2f66b29954afebd62f26"),
        .binaryTarget(name: "jsoncpp", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/jsoncpp.xcframework.zip", checksum: "7c0d3fa99b89ee006d5054090e55e00a1b45b4eb492e627b103e20081195d8f3"),
        .binaryTarget(name: "libOpen3D_3rdparty_liblzf.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/libOpen3D_3rdparty_liblzf.a.xcframework.zip", checksum: "7e2b1e39c8582e967b0b9d552f6d18c72bcd6570357250cc805c4ded9de782ff"),
        .binaryTarget(name: "libOpen3D_3rdparty_qhull_r.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/libOpen3D_3rdparty_qhull_r.a.xcframework.zip", checksum: "2961cbe16ce842563aed1a6ace49657619443e1b0cdde21d199550654737f2cd"),
        .binaryTarget(name: "libOpen3D_3rdparty_qhullcpp.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/libOpen3D_3rdparty_qhullcpp.a.xcframework.zip", checksum: "cb936e4a07680063de696b2675e9bfa9ce6de4b9d99d71ad4e949151f9118714"),
        .binaryTarget(name: "libOpen3D_3rdparty_rply.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/libOpen3D_3rdparty_rply.a.xcframework.zip", checksum: "261c77a56b64d9673e9ba75660431950ba2e7400234ab75d7d927fe802009530"),
        .binaryTarget(name: "libOpen3D.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/libOpen3D.a.xcframework.zip", checksum: "6e30b1233441d7f8afe167a7a851bdf27d5b63d051a15ebb308605077e55493b"),
        .binaryTarget(name: "png", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/png.xcframework.zip", checksum: "0778f2f22e7d4b5442173f2b5c9bef332b1f690a968de722c0b30aec12da2545"),
        .binaryTarget(name: "pybind.a", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/pybind.a.xcframework.zip", checksum: "6a5ff767d6f642a558a4ea47a7d627147a12860dde1b2161eba54431a0532029"),
        .binaryTarget(name: "TBB", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/TBB.xcframework.zip", checksum: "604dbe561c78785e7d1dac1a2be6c777aa8368ffc481c4b337297c6b13c501a3"),
        // .binaryTarget(name: "libvtkCommonComputationalGeometry", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_Common_Computational.xcframework.zip", checksum: "7bbab4ae9debfceeb3d57994b2e4481b1d2fb103906aabc255be550f25cf9fad"),
        .binaryTarget(name: "libvtkCommonDataModel", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_common_data_model.xcframework.zip", checksum: "42d8c3af5f5af488b4b12dccee72a0c19bf60306715eb734f454d57422052d9c"),
        .binaryTarget(name: "libvtkCommonMath", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_common_math.xcframework.zip", checksum: "f2eeab292dd58740a8dff0bf30e4d5e16b45f20171564b1fc4dee6c3923659bc"),
        .binaryTarget(name: "libvtkCommonExecutionModel", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_common_execution.xcframework.zip", checksum: "a44e47f5aac1f2f264997e0200bd3ddcfd64907f5cb1a462c62108c530b87840"),
        .binaryTarget(name: "libvtkCommonMisc", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_common_misc.xcframework.zip", checksum: "25014629429d4e44eceb15a88496583c3e262220c7ba9949d321d97317dd2e69"),
        .binaryTarget(name: "libvtkCommonSystem", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_common_sys.xcframework.zip", checksum: "50800ea12ef702876136d18e0270ed43aa8cd4402ffaeb3371bf3f4a3d3b8637"),
        .binaryTarget(name: "libvtkCommonCore", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_common_core.xcframework.zip", checksum: "a15390e0a8dfcb1a4a50f10c722b3e4e06526c162923ea7bc8686bb6f9f077f4"),
        .binaryTarget(name: "libvtkCommonTransforms", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_common_trans.xcframework.zip", checksum: "aafa54a91ae7ce814dd815b85d0e21570c55c313758cf54436185f0e2101f989"),
        
        .binaryTarget(name: "libvtkFiltersCore", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_filte_core.xcframework.zip", checksum: "f24ce90fb155d82be3f3f9045f953f7d90ee2596ef01a81e6596c3fdc92eaad9"),
        .binaryTarget(name: "libvtkFiltersGeneral", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_filte_general.xcframework.zip", checksum: "ebb19ddbca5a6ec386339f2357511cc2a3e0cd4680aa77ab1ddf3605e4238096"),
        .binaryTarget(name: "libvtkFiltersModeling", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_filte_model.xcframework.zip", checksum: "effcb7f9cde6935804254ccc6b8a0f1392008c49040b4fd2d28900e20a7f37ea"),
        .binaryTarget(name: "libvtkFiltersSources", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_filte_src.xcframework.zip", checksum: "3a7d7dcbbd2b00ad078397e7fe903014a41abc4403e9b98a82ab47396f59cdd0"),
        .binaryTarget(name: "libvtkfmt", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_fmt.xcframework.zip", checksum: "ec8a863ef184544bff636b0309632b8e92d1a52f0999f12b048209d01de609e6"),
        // .binaryTarget(name: "libvtkkissfft", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_kiss_fft.xcframework.zip", checksum: "5986dbe397f7b5447956451ee6d13fc971bf80ea3f85ccced8e08918a1d41a5c"),
        .binaryTarget(name: "libvtkpugixml", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_plugin_xml.xcframework.zip", checksum: "e6006d091534042cc9e1d401a59ae676c6edf0d410cd7d8729442263525ef7fa"),
        .binaryTarget(name: "libvtksys", url: "https://github.com/windcludy/Open3D-iOS/releases/download/0.0.20240519194238/VTK_sys.xcframework.zip", checksum: "01425c6d40fe7c3da8c7fd93635482dca3b78ff4e4ac77707fbc770488e07a60"),
        .target(
            name: "LinkOpen3D",
            dependencies: [
                "NumPy-iOS",
                "LAPACKE-iOS",
                "Assimp",
                "JPEG",
                "jsoncpp",
                "libOpen3D_3rdparty_liblzf.a",
                "libOpen3D_3rdparty_qhull_r.a",
                "libOpen3D_3rdparty_qhullcpp.a",
                "libOpen3D_3rdparty_rply.a",
                "libOpen3D.a",
                "png",
                "pybind.a",
                "TBB",
                "BLAS-LAPACK-AppStore-Workaround",
                // "libvtkCommonComputationalGeometry",
                "libvtkCommonDataModel",
                "libvtkCommonMath",
                "libvtkCommonExecutionModel",
                "libvtkCommonMisc",
                "libvtkCommonSystem",
                "libvtkCommonCore",
                "libvtkCommonTransforms",
                "libvtkFiltersCore",
                "libvtkFiltersGeneral",
                "libvtkFiltersModeling",
                "libvtkFiltersSources",
                "libvtkfmt",
                // "libvtkkissfft",
                "libvtkpugixml",
                "libvtksys",
            ],
            linkerSettings: [
                .linkedLibrary("stdc++"),
            ]
        ),
        .target(
            name: "Open3DSupport",
            resources: [.copy("site-packages")]),
        .testTarget(
            name: "Open3D-iOSTests",
            dependencies: ["Open3DSupport"]),
    ]
)
